<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•°æ®å¯è§†åŒ–æµ‹è¯• - å®‰å…¨ç®¡ç†äº¤äº’å¹³å°</title>
  <link rel="stylesheet" href="./styles/main.css">
  <style>
    body {
      padding: 20px;
      background: #f8fafc;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .test-section {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .test-section h2 {
      margin: 0 0 20px 0;
      color: #1f2937;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 12px;
    }
    
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .chart-container {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 16px;
      background: #fafafa;
    }
    
    .chart-container h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      color: #374151;
    }
    
    .test-controls {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 8px 16px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .btn:hover {
      background: #f3f4f6;
      border-color: #9ca3af;
    }
    
    .btn.primary {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    .btn.primary:hover {
      background: #2563eb;
    }
    
    .status {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .status.success {
      background: #dcfce7;
      color: #166534;
    }
    
    .status.error {
      background: #fee2e2;
      color: #991b1b;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <header>
      <h1>ğŸ“Š æ•°æ®å¯è§†åŒ–åŠŸèƒ½æµ‹è¯•</h1>
      <p>æµ‹è¯•æ–°å¼€å‘çš„å›¾è¡¨ç»„ä»¶å’Œæ•°æ®å¯è§†åŒ–åŠŸèƒ½</p>
    </header>

    <!-- åŸºç¡€å›¾è¡¨æµ‹è¯• -->
    <section class="test-section">
      <h2>åŸºç¡€å›¾è¡¨ç»„ä»¶æµ‹è¯•</h2>
      <div class="test-controls">
        <button class="btn primary" onclick="testBasicCharts()">æµ‹è¯•åŸºç¡€å›¾è¡¨</button>
        <button class="btn" onclick="testChartAnimations()">æµ‹è¯•åŠ¨ç”»æ•ˆæœ</button>
        <button class="btn" onclick="testChartInteractions()">æµ‹è¯•äº¤äº’åŠŸèƒ½</button>
        <span id="basic-status" class="status"></span>
      </div>
      
      <div class="chart-grid">
        <div class="chart-container">
          <h3>æŸ±çŠ¶å›¾æµ‹è¯•</h3>
          <div id="bar-chart" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>æŠ˜çº¿å›¾æµ‹è¯•</h3>
          <div id="line-chart" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>é¥¼å›¾æµ‹è¯•</h3>
          <div id="pie-chart" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>ç¯å½¢å›¾æµ‹è¯•</h3>
          <div id="doughnut-chart" style="height: 300px;"></div>
        </div>
      </div>
    </section>

    <!-- å­¦ä¹ è¿›åº¦å›¾è¡¨æµ‹è¯• -->
    <section class="test-section">
      <h2>å­¦ä¹ è¿›åº¦å›¾è¡¨æµ‹è¯•</h2>
      <div class="test-controls">
        <button class="btn primary" onclick="testProgressCharts()">æµ‹è¯•è¿›åº¦å›¾è¡¨</button>
        <button class="btn" onclick="testProgressAnimations()">æµ‹è¯•è¿›åº¦åŠ¨ç”»</button>
        <span id="progress-status" class="status"></span>
      </div>
      
      <div class="chart-grid">
        <div class="chart-container">
          <h3>å­¦ä¹ è¿›åº¦è¶‹åŠ¿</h3>
          <div id="progress-trend" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>å®Œæˆç‡ç¯å½¢å›¾</h3>
          <div id="completion-rate" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>å­¦ä¹ è·¯å¾„è¿›åº¦</h3>
          <div id="learning-path" style="height: 300px;"></div>
        </div>
      </div>
    </section>

    <!-- ç­”é¢˜ç»Ÿè®¡å›¾è¡¨æµ‹è¯• -->
    <section class="test-section">
      <h2>ç­”é¢˜ç»Ÿè®¡å›¾è¡¨æµ‹è¯•</h2>
      <div class="test-controls">
        <button class="btn primary" onclick="testQuizCharts()">æµ‹è¯•ç­”é¢˜å›¾è¡¨</button>
        <button class="btn" onclick="testKnowledgeRadar()">æµ‹è¯•çŸ¥è¯†ç‚¹é›·è¾¾å›¾</button>
        <span id="quiz-status" class="status"></span>
      </div>
      
      <div class="chart-grid">
        <div class="chart-container">
          <h3>æ­£ç¡®ç‡åˆ†å¸ƒ</h3>
          <div id="accuracy-distribution" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>ç­”é¢˜æ—¶é—´åˆ†æ</h3>
          <div id="time-analysis" style="height: 300px;"></div>
        </div>
        
        <div class="chart-container">
          <h3>çŸ¥è¯†ç‚¹æŒæ¡é›·è¾¾å›¾</h3>
          <div id="knowledge-radar" style="height: 300px;"></div>
        </div>
      </div>
    </section>

    <!-- å®æ—¶ä»ªè¡¨æ¿æµ‹è¯• -->
    <section class="test-section">
      <h2>å®æ—¶æ•°æ®ä»ªè¡¨æ¿æµ‹è¯•</h2>
      <div class="test-controls">
        <button class="btn primary" onclick="testDashboard()">åˆå§‹åŒ–ä»ªè¡¨æ¿</button>
        <button class="btn" onclick="refreshDashboard()">åˆ·æ–°æ•°æ®</button>
        <button class="btn" onclick="toggleAutoRefresh()">åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°</button>
        <span id="dashboard-status" class="status"></span>
      </div>
      
      <div id="dashboard-container" style="min-height: 600px; border: 1px solid #e5e7eb; border-radius: 8px; margin-top: 20px;">
        <!-- ä»ªè¡¨æ¿å°†åœ¨è¿™é‡Œæ¸²æŸ“ -->
      </div>
    </section>
  </div>

  <!-- å¼•å…¥å›¾è¡¨ç»„ä»¶ -->
  <script type="module">
    import { ChartComponent } from './components/ChartComponent.js';
    import { ProgressChart } from './components/ProgressChart.js';
    import { QuizStatsChart } from './components/QuizStatsChart.js';
    import { DashboardWidget } from './components/DashboardWidget.js';

    // å…¨å±€å˜é‡
    window.charts = {};
    window.dashboard = null;

    // æµ‹è¯•åŸºç¡€å›¾è¡¨
    window.testBasicCharts = function() {
      try {
        // æŸ±çŠ¶å›¾
        const barChart = new ChartComponent(document.getElementById('bar-chart'));
        const barData = [
          { label: 'å®‰å…¨æ“ä½œ', value: 85 },
          { label: 'è¿è§„è¯†åˆ«', value: 78 },
          { label: 'åº”æ€¥å¤„ç†', value: 92 },
          { label: 'è®¾å¤‡ä½¿ç”¨', value: 73 }
        ];
        barChart.renderBarChart(barData);
        window.charts.bar = barChart;

        // æŠ˜çº¿å›¾
        const lineChart = new ChartComponent(document.getElementById('line-chart'));
        const lineData = Array.from({ length: 30 }, (_, i) => ({
          label: `ç¬¬${i+1}å¤©`,
          value: Math.floor(Math.random() * 50) + 50
        }));
        lineChart.renderLineChart(lineData);
        window.charts.line = lineChart;

        // é¥¼å›¾
        const pieChart = new ChartComponent(document.getElementById('pie-chart'));
        const pieData = [
          { label: 'å·²å®Œæˆ', value: 65 },
          { label: 'è¿›è¡Œä¸­', value: 25 },
          { label: 'æœªå¼€å§‹', value: 10 }
        ];
        pieChart.renderPieChart(pieData);
        window.charts.pie = pieChart;

        // ç¯å½¢å›¾
        const doughnutChart = new ChartComponent(document.getElementById('doughnut-chart'));
        doughnutChart.renderDoughnutChart(pieData, { centerText: 'æ€»è¿›åº¦' });
        window.charts.doughnut = doughnutChart;

        document.getElementById('basic-status').textContent = 'âœ… æµ‹è¯•æˆåŠŸ';
        document.getElementById('basic-status').className = 'status success';
      } catch (error) {
        console.error('åŸºç¡€å›¾è¡¨æµ‹è¯•å¤±è´¥:', error);
        document.getElementById('basic-status').textContent = 'âŒ æµ‹è¯•å¤±è´¥';
        document.getElementById('basic-status').className = 'status error';
      }
    };

    // æµ‹è¯•å­¦ä¹ è¿›åº¦å›¾è¡¨
    window.testProgressCharts = function() {
      try {
        // è¿›åº¦è¶‹åŠ¿å›¾
        const progressChart = new ProgressChart(document.getElementById('progress-trend'));
        const progressData = Array.from({ length: 30 }, (_, i) => ({
          date: new Date(Date.now() - (29-i) * 24 * 60 * 60 * 1000).toISOString(),
          progress: Math.floor(Math.random() * 30) + 70,
          details: `ç¬¬${i+1}å¤©å­¦ä¹ è¿›åº¦`
        }));
        progressChart.renderProgressTrend(progressData, { type: 'area' });

        // å®Œæˆç‡ç¯å½¢å›¾
        const completionChart = new ProgressChart(document.getElementById('completion-rate'));
        completionChart.renderCompletionRate({ completed: 85, total: 100 });

        // å­¦ä¹ è·¯å¾„è¿›åº¦
        const pathChart = new ProgressChart(document.getElementById('learning-path'));
        const pathData = [
          { name: 'åŸºç¡€å®‰å…¨çŸ¥è¯†', progress: 100 },
          { name: 'æ“ä½œè§„èŒƒå­¦ä¹ ', progress: 85 },
          { name: 'åº”æ€¥å¤„ç†åŸ¹è®­', progress: 60 },
          { name: 'å®è·µæ“ä½œè€ƒæ ¸', progress: 30 },
          { name: 'ç»¼åˆèƒ½åŠ›è¯„ä¼°', progress: 0 }
        ];
        pathChart.renderLearningPath(pathData);

        document.getElementById('progress-status').textContent = 'âœ… æµ‹è¯•æˆåŠŸ';
        document.getElementById('progress-status').className = 'status success';
      } catch (error) {
        console.error('è¿›åº¦å›¾è¡¨æµ‹è¯•å¤±è´¥:', error);
        document.getElementById('progress-status').textContent = 'âŒ æµ‹è¯•å¤±è´¥';
        document.getElementById('progress-status').className = 'status error';
      }
    };

    // æµ‹è¯•ç­”é¢˜ç»Ÿè®¡å›¾è¡¨
    window.testQuizCharts = function() {
      try {
        // æ­£ç¡®ç‡åˆ†å¸ƒ
        const accuracyChart = new QuizStatsChart(document.getElementById('accuracy-distribution'));
        const quizData = Array.from({ length: 50 }, (_, i) => ({
          correctAnswers: Math.floor(Math.random() * 10) + 1,
          totalQuestions: 10,
          timeSpent: Math.floor(Math.random() * 300) + 60
        }));
        accuracyChart.renderAccuracyDistribution(quizData);

        // ç­”é¢˜æ—¶é—´åˆ†æ
        const timeChart = new QuizStatsChart(document.getElementById('time-analysis'));
        const timeData = Array.from({ length: 20 }, (_, i) => ({
          timeSpent: Math.floor(Math.random() * 200) + 100,
          completedAt: new Date(Date.now() - i * 24 * 60 * 60 * 1000).toISOString()
        }));
        timeChart.renderTimeAnalysis(timeData);

        document.getElementById('quiz-status').textContent = 'âœ… æµ‹è¯•æˆåŠŸ';
        document.getElementById('quiz-status').className = 'status success';
      } catch (error) {
        console.error('ç­”é¢˜å›¾è¡¨æµ‹è¯•å¤±è´¥:', error);
        document.getElementById('quiz-status').textContent = 'âŒ æµ‹è¯•å¤±è´¥';
        document.getElementById('quiz-status').className = 'status error';
      }
    };

    // æµ‹è¯•çŸ¥è¯†ç‚¹é›·è¾¾å›¾
    window.testKnowledgeRadar = function() {
      try {
        const radarChart = new QuizStatsChart(document.getElementById('knowledge-radar'));
        const knowledgeData = [
          { name: 'å®‰å…¨æ“ä½œ', accuracy: 85, total: 25, correct: 21 },
          { name: 'è¿è§„è¯†åˆ«', accuracy: 78, total: 20, correct: 16 },
          { name: 'åº”æ€¥å¤„ç†', accuracy: 92, total: 15, correct: 14 },
          { name: 'è®¾å¤‡ä½¿ç”¨', accuracy: 73, total: 18, correct: 13 },
          { name: 'é˜²æŠ¤æªæ–½', accuracy: 88, total: 22, correct: 19 },
          { name: 'è§„ç« åˆ¶åº¦', accuracy: 81, total: 16, correct: 13 }
        ];
        radarChart.renderKnowledgePoints(knowledgeData);
      } catch (error) {
        console.error('é›·è¾¾å›¾æµ‹è¯•å¤±è´¥:', error);
      }
    };

    // æµ‹è¯•ä»ªè¡¨æ¿
    window.testDashboard = function() {
      try {
        const container = document.getElementById('dashboard-container');
        if (window.dashboard) {
          window.dashboard.destroy();
        }
        
        window.dashboard = new DashboardWidget(container, {
          refreshInterval: 10000,
          autoRefresh: false
        });
        
        window.dashboard.init().then(() => {
          document.getElementById('dashboard-status').textContent = 'âœ… åˆå§‹åŒ–æˆåŠŸ';
          document.getElementById('dashboard-status').className = 'status success';
        }).catch(error => {
          console.error('ä»ªè¡¨æ¿åˆå§‹åŒ–å¤±è´¥:', error);
          document.getElementById('dashboard-status').textContent = 'âŒ åˆå§‹åŒ–å¤±è´¥';
          document.getElementById('dashboard-status').className = 'status error';
        });
      } catch (error) {
        console.error('ä»ªè¡¨æ¿æµ‹è¯•å¤±è´¥:', error);
        document.getElementById('dashboard-status').textContent = 'âŒ æµ‹è¯•å¤±è´¥';
        document.getElementById('dashboard-status').className = 'status error';
      }
    };

    // åˆ·æ–°ä»ªè¡¨æ¿
    window.refreshDashboard = function() {
      if (window.dashboard) {
        window.dashboard.loadDashboardData();
      }
    };

    // åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°
    window.toggleAutoRefresh = function() {
      if (window.dashboard) {
        if (window.dashboard.refreshTimer) {
          window.dashboard.stopAutoRefresh();
          console.log('è‡ªåŠ¨åˆ·æ–°å·²åœæ­¢');
        } else {
          window.dashboard.startAutoRefresh();
          console.log('è‡ªåŠ¨åˆ·æ–°å·²å¯åŠ¨');
        }
      }
    };

    // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
    document.addEventListener('DOMContentLoaded', function() {
      console.log('æ•°æ®å¯è§†åŒ–æµ‹è¯•é¡µé¢å·²åŠ è½½');
      
      // å»¶è¿Ÿæ‰§è¡Œæµ‹è¯•ï¼Œç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½å·²åŠ è½½
      setTimeout(() => {
        testBasicCharts();
        testProgressCharts();
        testQuizCharts();
        testKnowledgeRadar();
      }, 500);
    });
  </script>
</body>
</html>
